"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdateminimal_vue_webpack"]("main",{

/***/ "./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-auto-import!./node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./frontend_app/pages/course/components/SubmissionCard.vue?vue&type=script&lang=js":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-auto-import!./node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./frontend_app/pages/course/components/SubmissionCard.vue?vue&type=script&lang=js ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/apiClient */ \"./frontend_app/lib/apiClient.js\");\n/* harmony import */ var element_plus__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! element-plus */ \"./node_modules/element-plus/es/components/message/index.mjs\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jszip */ \"./node_modules/jszip/dist/jszip.min.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! file-saver */ \"./node_modules/file-saver/dist/FileSaver.min.js\");\n/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_2__);\n/* unplugin-vue-components disabled */\n\n\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  emits: ['edit-assignment', 'delete-assignment'],\n  props: {\n    assignment: {\n      type: Object,\n      required: true\n    },\n    currentRole: String\n  },\n  data() {\n    return {\n      showUploadSection: false,\n      file_name: '',\n      comments: '',\n      fileList: [],\n      submissions: [],\n      allSubmissions: [],\n      dialogWidth: \"800px\",\n    }\n  },\n  watch: {\n    currentRole: function(newVal, oldVal) {\n      if (newVal != 'student' && oldVal == 'student') {\n        this.fetchAllSubmissions()\n      }\n    }\n  },\n  created() {\n    this.fetchSubmissions();\n    if (this.currentRole != 'student') {\n      this.fetchAllSubmissions()\n    }\n  },\n  mounted() {\n    window.onresize = () => {\n      return (() => {\n        this.setDialogWidth();\n      })();\n    };\n  },\n  methods: {\n    downloadFile(fileName, content) {\n      const blob = new Blob([content], { type: 'text/markdown;charset=utf-8;' });\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = fileName;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    },\n    downloadZip() {\n      const zip = new (jszip__WEBPACK_IMPORTED_MODULE_1___default())();\n      this.allSubmissions.forEach(file => {\n        zip.file(file.id+'_'+file.account_name+'_'+file.name, file.content);\n      });\n      zip.generateAsync({type:\"blob\"})\n        .then((content) => {\n          (0,file_saver__WEBPACK_IMPORTED_MODULE_2__.saveAs)(content, this.assignment.name+\".zip\");\n        });\n    },\n    setDialogWidth() {\n      let windowSize = document.body.clientWidth;\n      const defaultWidth = 800;\n      if (windowSize < defaultWidth) {\n        this.dialogWidth = \"100%\";\n      } else {\n        this.dialogWidth = defaultWidth + \"px\";\n      }\n    },\n    startAssignment() {\n      this.showUploadSection = true;\n    },\n    cancelUpload() {\n      this.showUploadSection = false;\n    },\n    submitAssignment() {\n      if (!this.fileList.length) {\n        element_plus__WEBPACK_IMPORTED_MODULE_3__.ElMessage.error('Please add a file.')\n        return;\n      }\n\n      let file_name = this.fileList[0].name;\n      const reader = new FileReader();\n      reader.onload = e => {\n        const content = e.target.result;\n        const formData = {};\n        formData['name'] = file_name;\n        formData['content'] = content;\n        formData['comment'] = this.comments;\n        this.postSubmission(formData)\n      };\n      reader.onerror = () => {\n        element_plus__WEBPACK_IMPORTED_MODULE_3__.ElMessage.error('Error reading file.')\n      };\n      reader.readAsText(this.fileList[0].raw);\n    },\n    beforeUpload(file) {\n      const allowedTypes = ['Rmd', 'md'];\n      const isRmdOrMd = allowedTypes.some(type => file.name.includes(`.${type}`));\n      const isExceedingLimit = this.fileList.length >= 1;\n      \n      if (!isRmdOrMd) {\n        element_plus__WEBPACK_IMPORTED_MODULE_3__.ElMessage.error('Only .rmd and .md files are allowed!')\n        this.fileList = []\n        return false;\n      }\n      \n      if (isExceedingLimit) {\n        element_plus__WEBPACK_IMPORTED_MODULE_3__.ElMessage.error('You can only upload one file!')\n        return false;\n      }\n      \n      this.fileList = [file];\n      return true;\n    },\n    handleExceed(files, fileList) {\n      element_plus__WEBPACK_IMPORTED_MODULE_3__.ElMessage.error('You can only upload one file!')\n    },\n    handleRemove(file, fileList) {\n      this.fileList = this.fileList.filter(item => item.uid !== file.uid);\n    },\n    fetchSubmissions() {\n      _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getSubmissions(this.assignment.course_id, this.assignment.id)\n        .then(response => {\n          this.submissions = response.data.submission;\n        })\n        .catch(error => {\n          console.error(\"Error fetching submissions:\", error);\n        });\n    },\n    fetchAllSubmissions() {\n      _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getAllSubmissions(this.assignment.course_id, this.assignment.id)\n        .then(response => {\n          this.allSubmissions = response.data.submission;\n        })\n        .catch(error => {\n          console.error(\"Error fetching submissions:\", error);\n        });\n    },\n    postSubmission(submission) {\n      _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__[\"default\"].postSubmission(this.assignment.course_id, this.assignment.id,  submission)\n        .then(response => {\n          this.showUploadSection = false;\n          this.fetchSubmissions();\n        })\n        .catch(error => {\n          console.error(\"Error updating submission:\", error);\n        });\n    },\n    editSubmission(submission) {\n      _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateSubmission(this.assignment.course_id, this.assignment.id, submission.id, submission)\n        .then(response => {\n          this.fetchSubmissions();\n        })\n        .catch(error => {\n          console.error(\"Error updating submission:\", error);\n        });\n    },\n    deleteSubmission(submissionId) {\n      _lib_apiClient__WEBPACK_IMPORTED_MODULE_0__[\"default\"].deleteSubmission(this.assignment.course_id, this.assignment.id, submissionId)\n        .then(response => {\n          this.fetchSubmissions();\n        })\n        .catch(error => {\n          console.error(\"Error deleting submission:\", error);\n        });\n    },\n    getLocalDateString(utcStr=null) {\n      if (typeof utcStr !== 'string') {\n        return false;\n      }\n      const parts = utcStr.match(/(\\d{4})-(\\d{2})-(\\d{2}) (\\d{2}):(\\d{2}):(\\d{2}) \\+0000/);\n      if (!parts) {\n        console.error('Invalid date format:', utcStr);\n        return false;\n      }\n\n      const date = new Date(Date.UTC(parts[1], parts[2] - 1, parts[3], parts[4], parts[5], parts[6]));\n\n      return date.getFullYear()\n        + '-' + String(date.getMonth() + 1).padStart(2, '0')\n        + '-' + String(date.getDate()).padStart(2, '0')\n        + ' ' + String(date.getHours()).padStart(2, '0')\n        + ':' + String(date.getMinutes()).padStart(2, '0');\n    }\n  }\n});\n\n\n//# sourceURL=webpack://minimal-vue-webpack/./frontend_app/pages/course/components/SubmissionCard.vue?./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-auto-import!./node_modules/vue-loader/dist/index.js??ruleSet%5B1%5D.rules%5B6%5D.use%5B0%5D");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("319aaa7abb7aa5ff9284")
/******/ })();
/******/ 
/******/ }
);